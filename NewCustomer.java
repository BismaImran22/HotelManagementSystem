package Hotel.Management.System;import javax.swing.*;import java.awt.*;import java.awt.event.ActionEvent;import java.awt.event.ActionListener;import java.io.*;import java.util.Date;import java.util.Vector;public class NewCustomer extends JFrame implements ActionListener {    // --- Standardized Theme Colors ---    private static final Color DARK_BACKGROUND = new Color(5, 5, 5);    private static final Color FIELD_BACKGROUND = new Color(115, 75, 16);    private static final Color TEXT_COLOR = Color.WHITE;    private static final Color ACCENT_COLOR = new Color(255, 215, 0); // Gold accent    private static final Color BUTTON_BG = Color.BLACK;    // ---------------------------------    // Fields    JComboBox comboBox; // For ID Type    JTextField textFieldNumber, TextName, TextCountry, TextDeposite; // Input fields    JRadioButton r1, r2; // For Gender    Choice c1; // For Room Number    JLabel date; // For Check In Time display    JButton add, back; // Action buttons    NewCustomer() {        // --- Frame Setup ---        super("New Customer Registration");        JPanel panel = new JPanel();        panel.setBounds(5, 5, 840, 540);        panel.setLayout(null);        panel.setBackground(DARK_BACKGROUND); // Apply Dark Theme        add(panel);        // --- Header Label ---        JLabel labelName = new JLabel("NEW CUSTOMER FORM");        labelName.setBounds(118, 11, 260, 53);        labelName.setFont(new Font("Tahoma", Font.BOLD, 20));        labelName.setForeground(ACCENT_COLOR); // Apply Gold Accent        panel.add(labelName);        // --- ID Type ---        JLabel labelID = new JLabel("ID Type");        labelID.setBounds(60, 80, 150, 27);        labelID.setFont(new Font("Tahoma", Font.BOLD, 17));        labelID.setForeground(TEXT_COLOR);        panel.add(labelID);        comboBox = new JComboBox(new String[]{"Passport", "Aadhar Card", "Driving License", "Voter Id Card"});        comboBox.setBounds(200, 80, 150, 27);        comboBox.setBackground(FIELD_BACKGROUND);        comboBox.setForeground(TEXT_COLOR);        comboBox.setFont(new Font("Tahoma", Font.PLAIN, 14)); // Consistent font size        panel.add(comboBox);        // --- ID Number ---        JLabel labelNumber = new JLabel("ID Number");        labelNumber.setBounds(60, 120, 150, 27);        labelNumber.setFont(new Font("Tahoma", Font.BOLD, 17));        labelNumber.setForeground(TEXT_COLOR);        panel.add(labelNumber);        textFieldNumber = new JTextField();        textFieldNumber.setBounds(200, 120, 150, 27);        textFieldNumber.setBackground(FIELD_BACKGROUND);        textFieldNumber.setForeground(TEXT_COLOR);        textFieldNumber.setFont(new Font("Tahoma", Font.BOLD, 14));        panel.add(textFieldNumber);        // --- Name ---        JLabel labelName2 = new JLabel("Name");        labelName2.setBounds(60, 160, 150, 27);        labelName2.setFont(new Font("Tahoma", Font.BOLD, 17));        labelName2.setForeground(TEXT_COLOR);        panel.add(labelName2);        TextName = new JTextField();        TextName.setBounds(200, 160, 150, 27);        TextName.setBackground(FIELD_BACKGROUND);        TextName.setForeground(TEXT_COLOR);        TextName.setFont(new Font("Tahoma", Font.BOLD, 14));        panel.add(TextName);        // --- Gender ---        JLabel labelGender = new JLabel("Gender");        labelGender.setBounds(60, 200, 150, 27);        labelGender.setFont(new Font("Tahoma", Font.BOLD, 17));        labelGender.setForeground(TEXT_COLOR);        panel.add(labelGender);        r1 = new JRadioButton("Male");        r1.setBounds(200, 200, 70, 27);        r1.setBackground(DARK_BACKGROUND);        r1.setForeground(TEXT_COLOR);        r1.setFont(new Font("Tahoma", Font.BOLD, 14));        panel.add(r1);        r2 = new JRadioButton("Female");        r2.setBounds(280, 200, 90, 27);        r2.setBackground(DARK_BACKGROUND);        r2.setForeground(TEXT_COLOR);        r2.setFont(new Font("Tahoma", Font.BOLD, 14));        panel.add(r2);        ButtonGroup group = new ButtonGroup();        group.add(r1);        group.add(r2);        r1.setSelected(true); // Default selection        // --- Country ---        JLabel labelCountry = new JLabel("Country");        labelCountry.setBounds(60, 235, 150, 27);        labelCountry.setFont(new Font("Tahoma", Font.BOLD, 17));        labelCountry.setForeground(TEXT_COLOR);        panel.add(labelCountry);        TextCountry = new JTextField();        TextCountry.setBounds(200, 235, 150, 27);        TextCountry.setBackground(FIELD_BACKGROUND);        TextCountry.setForeground(TEXT_COLOR);        TextCountry.setFont(new Font("Tahoma", Font.BOLD, 14));        panel.add(TextCountry);        // --- Room Number ---        JLabel room = new JLabel("Room Number");        room.setBounds(60, 270, 150, 27);        room.setFont(new Font("Tahoma", Font.BOLD, 17));        room.setForeground(TEXT_COLOR);        panel.add(room);        c1 = new Choice();        c1.setBounds(200, 270, 150, 27);        c1.setBackground(FIELD_BACKGROUND);        c1.setForeground(TEXT_COLOR);        c1.setFont(new Font("Tahoma", Font.PLAIN, 14));        panel.add(c1);        // --- Logic: Load AVAILABLE Room Numbers from rooms.csv ---        try (BufferedReader br = new BufferedReader(new FileReader("rooms.csv"))) {            String line;            // Assuming the CSV might have a header, it's safer not to skip it here,            // as room creation might not always write one. Check against availability.            while ((line = br.readLine()) != null) {                String[] data = line.split(",", -1);                // rooms.csv fields: Room_Number(0), Availability(1), Clean_Status(2), Price(3), Bed_Type(4)                // Check if availability (data[1]) is "Available"                if (data.length >= 2 && data[1].trim().equalsIgnoreCase("Available")) {                    c1.add(data[0].trim()); // Add Room Number (data[0])                }            }        } catch (IOException e) {            e.printStackTrace();            JOptionPane.showMessageDialog(this, "Error loading available rooms. Make sure 'rooms.csv' exists.", "File Error", JOptionPane.ERROR_MESSAGE);        }        // --- Check In Time ---        JLabel CheckInTime = new JLabel("Check In Time");        CheckInTime.setBounds(60, 310, 150, 27);        CheckInTime.setFont(new Font("Tahoma", Font.BOLD, 17));        CheckInTime.setForeground(TEXT_COLOR);        panel.add(CheckInTime);        date = new JLabel("" + new Date());        date.setBounds(200, 310, 250, 27);        date.setFont(new Font("Tahoma", Font.BOLD, 14));        date.setForeground(TEXT_COLOR);        panel.add(date);        // --- Deposit ---        JLabel labelDeposit = new JLabel("Deposit");        labelDeposit.setBounds(60, 350, 150, 27);        labelDeposit.setFont(new Font("Tahoma", Font.BOLD, 17));        labelDeposit.setForeground(TEXT_COLOR);        panel.add(labelDeposit);        TextDeposite = new JTextField();        TextDeposite.setBounds(200, 350, 150, 27);        TextDeposite.setBackground(FIELD_BACKGROUND);        TextDeposite.setForeground(TEXT_COLOR);        TextDeposite.setFont(new Font("Tahoma", Font.BOLD, 14));        panel.add(TextDeposite);        // --- Buttons ---        add = new JButton("ADD");        add.setBounds(80, 420, 100, 30);        add.setBackground(BUTTON_BG);        add.setForeground(TEXT_COLOR);        add.addActionListener(this);        panel.add(add);        back = new JButton("Back");        back.setBounds(200, 420, 100, 30);        back.setBackground(BUTTON_BG);        back.setForeground(TEXT_COLOR);        back.addActionListener(this);        panel.add(back);        // --- Image ---        try {            ImageIcon imageIcon = new ImageIcon(ClassLoader.getSystemResource("icon/customer.png"));            Image image = imageIcon.getImage().getScaledInstance(200, 200, Image.SCALE_DEFAULT);            ImageIcon imageIcon1 = new ImageIcon(image);            JLabel imglabel = new JLabel(imageIcon1);            imglabel.setBounds(550, 150, 200, 200);            panel.add(imglabel);        } catch (Exception e) {            System.err.println("Error loading image: icon/customer.png");        }        // --- Final Frame Properties ---        setUndecorated(true);        setLayout(null);        setSize(850, 550);        // --- MANUAL CENTERING LOGIC (Guaranteed Center) ---        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();        int x = (screenSize.width - getWidth()) / 2; // Calculate X position        int y = (screenSize.height - getHeight()) / 2; // Calculate Y position        setLocation(x, y); // Set the calculated central position        // --------------------------------------------------        setVisible(true);    }    // ----------------------------------------------------------------------------------------------------    @Override    public void actionPerformed(ActionEvent e) {        if (e.getSource() == add) {            String idType = (String) comboBox.getSelectedItem();            String number = textFieldNumber.getText().trim();            String name = TextName.getText().trim();            String gender = r1.isSelected() ? "Male" : "Female";            String country = TextCountry.getText().trim();            String room = c1.getSelectedItem();            String checkinTime = date.getText(); // Get the current time/date string            String deposit = TextDeposite.getText().trim();            if (number.isEmpty() || name.isEmpty() || country.isEmpty() || room == null || room.isEmpty() || deposit.isEmpty()) {                JOptionPane.showMessageDialog(null, "Please fill all required fields.");                return;            }            // Customer data row: ID Type, Number, Name, Gender, Country, Room, CI Time, Deposit (8 fields)            String row = idType + "," + number + "," + name + "," + gender + "," + country + "," + room + "," + checkinTime + "," + deposit;            // 1. Write customer data to 'customer.csv'            try (FileWriter fw = new FileWriter("customer.csv", true);                 PrintWriter pw = new PrintWriter(fw)) {                pw.println(row);            } catch (IOException ex) {                ex.printStackTrace();                JOptionPane.showMessageDialog(null, "Error adding customer data!");                return;            }            // 2. Update room availability to "Occupied" in 'rooms.csv'            try {                updateRoomAvailability("rooms.csv", room, "Occupied");            } catch (IOException ex) {                ex.printStackTrace();                JOptionPane.showMessageDialog(null, "Error updating room status!");                return;            }            JOptionPane.showMessageDialog(null, "Customer and Room Added Successfully");            setVisible(false);        } else {            // Handle 'Back' button            setVisible(false);        }    }    // ----------------------------------------------------------------------------------------------------    /**     * Helper: updates the given room's availability in a CSV file.     * Searches for the room number (first column) and updates the availability (second column).     */    private static void updateRoomAvailability(String fileName, String roomNo, String newStatus) throws IOException {        File inputFile = new File(fileName);        File tempFile = new File(fileName + ".tmp");        try (BufferedReader reader = new BufferedReader(new FileReader(inputFile));             PrintWriter writer = new PrintWriter(new BufferedWriter(new FileWriter(tempFile)))) {            String line;            while ((line = reader.readLine()) != null) {                String[] row = line.split(",", -1);                // Check if the line has at least 2 fields and the first field matches the room number                if (row.length >= 2 && row[0].trim().equals(roomNo)) {                    // Update the availability status (second field, index 1)                    row[1] = newStatus;                    writer.println(String.join(",", row));                } else {                    writer.println(line);                }            }        }        // Atomically replace the original file with the temporary one        if (!inputFile.delete()) {            throw new IOException("Could not delete original file: " + fileName);        }        if (!tempFile.renameTo(inputFile)) {            throw new IOException("Could not rename temp file to: " + fileName);        }    }    // ----------------------------------------------------------------------------------------------------    public static void main(String[] args) {        new NewCustomer();    }}