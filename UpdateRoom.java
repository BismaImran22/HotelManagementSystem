package Hotel.Management.System;import javax.swing.*;import java.awt.*;import java.awt.event.*;import java.io.*;import java.util.*;import java.util.ArrayList;public class UpdateRoom extends JFrame {    // --- Standardized Theme Colors ---    private static final Color DARK_BACKGROUND = new Color(5, 5, 5);    private static final Color FIELD_BACKGROUND = new Color(115, 95, 16);    private static final Color TEXT_COLOR = Color.WHITE;    private static final Color ACCENT_COLOR = new Color(255, 215, 0); // Gold accent    private static final Color BUTTON_BG = Color.BLACK;    // ---------------------------------    private Choice choiceId;    private JTextField tfRoom, tfAvailability, tfClean;    private JButton check, update, back;    // Standardized File Names    private static final String CUSTOMER_FILE = "customer.csv";    private static final String ROOM_FILE = "rooms.csv";    UpdateRoom() {        JPanel panel = new JPanel();        panel.setBounds(5,5,940,490);        panel.setBackground(DARK_BACKGROUND); // Dark Theme        panel.setLayout(null);        add(panel);        // --- Header ---        JLabel label1  = new JLabel("Update Room Status");        label1.setBounds(124,11,300,25);        label1.setFont(new Font("Tahoma", Font.BOLD, 20));        label1.setForeground(ACCENT_COLOR); // Gold Accent        panel.add(label1);        // --- ID Label and Choice (For Customer ID Number) ---        JLabel label2  = new JLabel("ID Number:");        label2.setBounds(25,88,100,14);        label2.setFont(new Font("Tahoma", Font.BOLD, 14));        label2.setForeground(TEXT_COLOR);        panel.add(label2);        choiceId = new Choice();        choiceId.setBounds(248,85,140,20);        choiceId.setBackground(FIELD_BACKGROUND);        choiceId.setForeground(TEXT_COLOR);        panel.add(choiceId);        loadCustomerIDs(choiceId); // Load IDs        // Add ItemListener to automatically load details when a customer is selected        choiceId.addItemListener(new ItemListener() {            @Override            public void itemStateChanged(ItemEvent e) {                if (e.getStateChange() == ItemEvent.SELECTED) {                    loadRoomDetails(choiceId.getSelectedItem());                }            }        });        // --- Room Number ---        JLabel label3  = new JLabel("Room Number :");        label3.setBounds(25,129,120,14);        label3.setFont(new Font("Tahoma", Font.BOLD, 14));        label3.setForeground(TEXT_COLOR);        panel.add(label3);        tfRoom = new JTextField();        tfRoom.setBounds(248,129,140,20);        tfRoom.setBackground(FIELD_BACKGROUND);        tfRoom.setForeground(TEXT_COLOR);        tfRoom.setEditable(false); // Room number is fixed based on ID        panel.add(tfRoom);        // --- Availability ---        JLabel label4  = new JLabel("Availability :");        label4.setBounds(25,174,97,14);        label4.setFont(new Font("Tahoma", Font.BOLD, 14));        label4.setForeground(TEXT_COLOR);        panel.add(label4);        tfAvailability = new JTextField();        tfAvailability.setBounds(248,174,140,20);        tfAvailability.setBackground(FIELD_BACKGROUND);        tfAvailability.setForeground(TEXT_COLOR);        tfAvailability.setEditable(false); // Availability is read-only        panel.add(tfAvailability);        // --- Clean Status (Editable) ---        JLabel label5  = new JLabel("Clean Status :");        label5.setBounds(25,216,100,14);        label5.setFont(new Font("Tahoma", Font.BOLD, 14));        label5.setForeground(TEXT_COLOR);        panel.add(label5);        tfClean = new JTextField();        tfClean.setBounds(248,216,140,20);        tfClean.setBackground(FIELD_BACKGROUND);        tfClean.setForeground(TEXT_COLOR);        tfClean.setFont(new Font("Tahoma", Font.PLAIN, 12));        panel.add(tfClean);        // --- Image ---        try {            ImageIcon imageIcon = new ImageIcon(ClassLoader.getSystemResource("icon/clean.png"));            Image image = imageIcon.getImage().getScaledInstance(300, 300, Image.SCALE_DEFAULT);            ImageIcon imageIcon1 = new ImageIcon(image);            JLabel imglabel = new JLabel(imageIcon1);            imglabel.setBounds(500, 50, 400, 400);            panel.add(imglabel);        } catch (Exception e) {            System.err.println("Error loading image: icon/clean.png");        }        // -------------------- CHECK BUTTON --------------------        check = new JButton("CHECK");        check.setBounds(40,315,100,30);        check.setBackground(BUTTON_BG);        check.setForeground(TEXT_COLOR);        panel.add(check);        check.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                // View Room Details logic                loadRoomDetails(choiceId.getSelectedItem());            }        });        // -------------------- UPDATE BUTTON --------------------        update = new JButton("UPDATE");        update.setBounds(150,315,100,30);        update.setBackground(BUTTON_BG);        update.setForeground(TEXT_COLOR);        panel.add(update);        update.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                // Update Clean Status logic                updateRoomStatus();            }        });        // -------------------- BACK BUTTON --------------------        back = new JButton("BACK");        back.setBounds(260,315,100,30);        back.setBackground(BUTTON_BG);        back.setForeground(TEXT_COLOR);        panel.add(back);        back.addActionListener(e -> setVisible(false));        // Initial load for the first item        if (choiceId.getItemCount() > 0) {            choiceId.select(0);            loadRoomDetails(choiceId.getSelectedItem());        }        // --- Final Frame Properties ---        setUndecorated(true);        setLayout(null);        setSize(950,500);        // --- MANUAL CENTERING LOGIC ---        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();        int x = (screenSize.width - getWidth()) / 2;        int y = (screenSize.height - getHeight()) / 2;        setLocation(x, y);        // --------------------------------------------------        setVisible(true);    }    // ----------------------------------------------------------------------------------------------------    // --- Data Management Logic ---    // ----------------------------------------------------------------------------------------------------    /**     * Loads customer ID Numbers into the Choice component.     * Assuming NewCustomer.java does NOT write a header line.     */    private void loadCustomerIDs(Choice choice) {        choice.removeAll();        try (BufferedReader br = new BufferedReader(new FileReader(CUSTOMER_FILE))) {            String line;            // NOTE: Assuming no header line is present in customer.csv.            // If you find a header, uncomment the next line:            // br.readLine();            while ((line = br.readLine()) != null) {                String[] data = line.split(",", -1);                // The customer ID *Number* is at index 1 in the standard 8-field structure.                if (data.length >= 2) { // Ensure there are at least 2 fields                    choice.add(data[1].trim());                }            }        } catch (FileNotFoundException e) {            JOptionPane.showMessageDialog(null, "Error: The file '" + CUSTOMER_FILE + "' was not found.", "File Not Found", JOptionPane.ERROR_MESSAGE);        } catch (IOException e) {            JOptionPane.showMessageDialog(null, "Error loading customer IDs from " + CUSTOMER_FILE + ".");        }    }    /**     * Finds the room number for the selected customer ID, then loads the room's     * Availability and Clean Status into the text fields.     */    private void loadRoomDetails(String idNumber) {        if (idNumber == null || idNumber.isEmpty()) return;        // Clear fields        tfRoom.setText("");        tfAvailability.setText("");        tfClean.setText("");        String room = "";        // 1. Find the Room Number linked to the ID Number from customer.csv        try (BufferedReader br = new BufferedReader(new FileReader(CUSTOMER_FILE))) {            String line;            // Assuming no header in customer.csv. If there is, uncomment:            // br.readLine();            while ((line = br.readLine()) != null) {                String[] data = line.split(",", -1);                // customer.csv fields: ID_Type(0), ID_Number(1), ..., Room_Number(5), ...                if (data.length >= 6 && data[1].trim().equals(idNumber)) {                    // Room Number is in data[5]                    room = data[5].trim();                    tfRoom.setText(room);                    break;                }            }        } catch (IOException ex) {            JOptionPane.showMessageDialog(null, "Error finding room number in " + CUSTOMER_FILE + ".");            return;        }        if (room.isEmpty()) {            // Only show a message if the ID was selected but no room found            if (choiceId.getSelectedItem() != null && !choiceId.getSelectedItem().isEmpty()) {                JOptionPane.showMessageDialog(null, "No room found for ID: " + idNumber + ". They may not be checked in.");            }            return;        }        // 2. Load room details (Availability, Clean Status) from rooms.csv        try (BufferedReader br = new BufferedReader(new FileReader(ROOM_FILE))) {            String line;            // Assuming rooms.csv has a header (written by AddRoom.java)            br.readLine();            while ((line = br.readLine()) != null) {                String[] data = line.split(",", -1);                // rooms.csv fields: Room_Number(0), Availability(1), Clean_Status(2), Price(3), Bed_Type(4)                if (data.length >= 3 && data[0].trim().equals(room)) {                    tfAvailability.setText(data[1].trim());                    tfClean.setText(data[2].trim());                    break;                }            }        } catch (IOException ex) {            JOptionPane.showMessageDialog(null, "Error reading room details from " + ROOM_FILE + ".");        }    }    /**     * Updates the Clean Status in rooms.csv, preserving all other fields.     */    private void updateRoomStatus() {        String room = tfRoom.getText().trim();        String newCleanStatus = tfClean.getText().trim();        if (room.isEmpty() || newCleanStatus.isEmpty()) {            JOptionPane.showMessageDialog(null, "Room number and Clean Status must be loaded/filled.");            return;        }        // Basic validation for status        if (!newCleanStatus.equalsIgnoreCase("Clean") && !newCleanStatus.equalsIgnoreCase("Dirty")) {            JOptionPane.showMessageDialog(null, "Clean Status must be 'Clean' or 'Dirty'.");            return;        }        ArrayList<String> fileData = new ArrayList<>();        boolean roomFound = false;        // 1. Read existing room data, modify the target room line        try (BufferedReader br = new BufferedReader(new FileReader(ROOM_FILE))) {            String line;            // Read and store the header line (assuming AddRoom.java writes one)            String header = br.readLine();            if (header != null) {                fileData.add(header);            }            while ((line = br.readLine()) != null) {                String[] data = line.split(",", -1);                // rooms.csv fields: Room_Number(0), Availability(1), Clean_Status(2), Price(3), Bed_Type(4)                if (data.length >= 5 && data[0].trim().equals(room)) {                    roomFound = true;                    // Preserve original fields (0, 1, 3, 4), update only Clean Status (2)                    String updatedLine = data[0] + "," + data[1] + "," + newCleanStatus + "," + data[3] + "," + data[4];                    fileData.add(updatedLine);                } else {                    fileData.add(line);                }            }        } catch (IOException ex) {            JOptionPane.showMessageDialog(null, "Error reading file before update.");            return;        }        if (!roomFound) {            JOptionPane.showMessageDialog(null, "Room not found in database. Cannot update.");            return;        }        // 2. Write all data back to the file        try (BufferedWriter bw = new BufferedWriter(new FileWriter(ROOM_FILE))) {            for (String s : fileData) {                bw.write(s);                bw.newLine();            }            JOptionPane.showMessageDialog(null, "Room Status Updated Successfully!");            // Automatically close the window on successful update            setVisible(false);        } catch (IOException ex) {            ex.printStackTrace();            JOptionPane.showMessageDialog(null, "Error writing data back to file.");        }    }    public static void main(String[] args) {        new UpdateRoom();    }}